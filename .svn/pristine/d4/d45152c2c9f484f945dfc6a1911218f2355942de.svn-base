(function($,window,document){var version="2.5";$.extend($.fn,{taiji:function(opts){if(!this.length){if(window.console&&window.console.warn){window.console.warn("没有选择任何节点，直接返回");}return;}var aTaiji=$(this).data("aTaiji");if(aTaiji){return this;}aTaiji=new $.Taiji(opts,this);$(this).data("aTaiji",aTaiji);$(window).resize(function(){aTaiji.repostion();});$(document).scroll(function(){aTaiji.repostion();});return this;}});$.Taiji=function(opts,targetDiv){this.settings=$.extend(true,{},$.Taiji.defaults,opts);this.currentTarget=$(targetDiv);this.base64=new Base64();this.isRunning=false;this.decode=this.base64.decode;this.$warnDiv=$("<div class='taiji_warn'></div>").appendTo(this.currentTarget);this.$noteDiv=$("<div class='taiji_note'></div>").appendTo(this.currentTarget);this.$loadingDiv=$("<div class='taiji_loading'></div>").appendTo(this.currentTarget);this.aclCheck($(this.settings.aclClassName,this.currentTarget));this.$pl=this.$warnDiv.css("padding-left");this.$fs=this.$warnDiv.css("font-size");
this.$pl=this.$pl?parseInt(this.$pl,10)?parseInt(this.$pl,10):10:10;this.$fs=this.$fs?parseInt(this.$fs,10)?parseInt(this.$fs,10):12:12;this.repostion();this.searchFormClassName=this.settings.search.formClassName;this.searchSubmitClassName=this.settings.search.submitClassName;this.searchResetClassName=this.settings.search.resetClassName;this.searchAutoRefreshEnable=this.settings.search.autoRefresh.enable;this.searchAutoRefreshInterval=this.settings.search.autoRefresh.interval;this.nyroModalConf={defaults:{stack:this.settings.stack,closeOnClick:this.settings.closeOnClick,closeButton:null,sizes:{minW:this.settings.width,minH:this.settings.height}}};var $self=this;$.each($.Taiji.useNyroModals,function(i,name){$self.nyroModalConf[name]=$.extend(true,{},$self.nyroModalConf.defaults,{sizes:{minW:$self.settings[name].width,minH:$self.settings[name].height}});});this._init();};$.extend($.Taiji,{prototype:{_init:function(){$(this.currentTarget).addClass("_taiji_");this._configRunning();this._bindSearchSubmitClick();
this._bindSearchResetClick();this._bindSerachFormValidate();this._bindSearchFormInputEnter();this._bindAll();if(this.settings.search.autoSearch===true){$(this.searchFormClassName,this.currentTarget).trigger("submit");}else{if(this.settings.search.thInThead===true){$(this.settings.search.resultClassName,this.currentTarget).find("> table > tbody").empty().append("<tr><td colspan='15' ><div class='taiji_not_found'>请先填写查询条件！</div></td></tr>");}else{$(this.settings.search.resultClassName,this.currentTarget).find("> table > tbody").find("tr:gt(0)").remove().end().append("<tr><td colspan='15' ><div class='taiji_not_found'>请先填写查询条件！</div></td></tr>");}}},_bindAll:function(){var $self=(this),events={},classNames={},$target=$(this.currentTarget);$.each($.Taiji.events,function(event,coll){if(!events[event]){events[event]={};}$.each(coll,function(name,other){$.each(other,function(cn,handler){var className=$self.settings[name][cn];events[event][className]=handler;});});});$.each(events,function(aEvent,cllol){$target.off(aEvent+".taiji").on(aEvent+".taiji",function(event){var $target=($(event.target).is("a")||$(event.target).is(":checkbox")||$(event.target).is("th"))?$(event.target):($(event.target).parents().is("a")&&$(event.target).parents("a"))?$(event.target).parents("a"):$self._emptyTarget;
$.each(cllol,function(className,handler){if($target.is(className)){$self[handler]($target);$.Taiji.preventDefault(event);}});});});$.each($.Taiji.customEvents,function(name,handler){$target.off(name).on(name,function(event,form,options){$self[handler](form,options);});});},_emptyTarget:{is:function(className){return false;}},_configRunning:function(){var $self=this,nmTop=$.nmTop();var options={};options["myinit"+this.currentTarget.attr("id")]={is:function(nm){return true;},initElts:function(nm){$self.isRunning=true;$self.log("禁用--init");},afterShowCont:function(nm){$(".taiji_validator").remove();$.placeholderAll();$.autocompleteAll();},beforeClose:function(nm){if(nm.getInternal().stack.length>0){return;}$self.isRunning=false;$self.log("启用");$(".taiji_validator").remove();$(".taiji_placeholder").remove();},afterClose:function(nm){$.placeholderAll();}};if(!(nmTop&&nmTop.getInternal)){$.nmFilters(options);}},_bindSearchFormInputEnter:function(){var $self=this;$(this.searchFormClassName,this.currentTarget).find(":input:text").keydown(function(event){var $target=$(event.target);
if(event.keyCode===13){if($target.is(".taiji_pager_input")){$self._handleGotoClick($target.parent().find(".taiji_pager_goto"));}else{$($self.searchSubmitClassName,$self.currentTarget).trigger("click");}}});},_bindSerachFormValidate:function(){var $this=this;if($.fn.validate){this.searchFormValidate=$(this.searchFormClassName,this.currentTarget).validate({rules:$this.settings.search.rules||{},messages:$this.settings.search.messages||{},submitHandler:function(form){$this._search(form);}});}else{$(this.searchFormClassName,this.currentTarget).on("submit",function(event){$this._search($(this));$.Taiji.preventDefault(event);});}},_bindSearchSubmitClick:function(){var $this=this;$(this.searchSubmitClassName,this.currentTarget).click(function(event){$($this.searchFormClassName,$this.currentTarget).trigger("submit");$.Taiji.preventDefault(event);});},_bindSearchResetClick:function(){var $this=this;$(this.searchResetClassName,this.currentTarget).click(function(event){$($this.searchFormClassName,$this.currentTarget).trigger("reset");
$.Taiji.preventDefault(event);});},_search:function(form){if(this.isRunning===true){this.warn($.Taiji.Messages.WAR_OPERATE);return;}else{this.isRunning=true;}var $this=this,options={success:function success(responseText,status,xhr){var responseHeader={note:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_NOTE),jme:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_JME),me:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_ME),cve:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_CVE)};$this._removeLoading();$($this.searchSubmitClassName,$this.currentTarget).attr("disabled",false);$this.isRunning=false;if(responseHeader.note){$this.warn("查询成功:"+$this.decode(responseHeader.note));}else{if(responseHeader.jme){$this.warn("查询失败:"+$this.decode(responseHeader.jme));}else{if(responseHeader.me){$this.warn("查询失败:"+$this.decode(responseHeader.me));}else{if(responseHeader.cve){var ejson=$(responseText).find("#taiji_ejson");var ejsonContent=$.parseJSON($(ejson).html());$.each(ejsonContent,function(i,n){$("[name='"+i+"']",$this.currentTarget).remind(n);
});}else{$this._handleSearchSuccess(responseText);}}}}},error:function error(xhr){$this._handleSearchError(xhr.status);}};this._createLoading($.Taiji.Messages.MSG_OPERATE);$(this.searchSubmitClassName,this.currentTarget).attr("disabled",true);$(this.searchFormClassName,this.currentTarget).ajaxSubmit(options);},_bindDataChange:function(){this._bindCssToggle();},_handleSearchSuccess:function(responseText){var $responseText=$(responseText);if($responseText.is("table")){$(this.settings.search.resultClassName,this.currentTarget).html($(responseText));this._bindPager_8();}else{if(this.version<"2.0.13"){this._bindPager_9($responseText.find("#taiji_search_pager"));}else{this._bindPager($responseText.find("#taiji_search_pager"));}var hasText=$responseText.find("#taiji_search_data tbody").children().size()>0;if(hasText===true){var $tbody=$responseText.find("#taiji_search_data tbody");this.aclCheck($tbody);var $trs,trsIndex=0,$myBody;if(this.settings.search.thInThead===true){$myBody=$(this.settings.search.resultClassName,this.currentTarget).find("> table > tbody");
$myBody.empty().append($tbody.html());if(this.settings.search.autoAddOrder===true){var $headTr=$(this.settings.search.resultClassName,this.currentTarget).find("> table > thead").find("tr:eq(0)");if($headTr.find("th:eq(0)").text()!=="序号"){$headTr.prepend("<th>序号</th>");}$trs=$myBody.children();$.each($trs,function(){++trsIndex;$(this).prepend("<td>"+trsIndex+"</td>");});}}else{$myBody=$(this.settings.search.resultClassName,this.currentTarget).find("> table > tbody");$myBody.find("tr:gt(0)").remove().end().append($tbody.html());if(this.settings.search.autoAddOrder===true){var $bodyTr=$myBody.find("tr:eq(0)");if($bodyTr.find("th:eq(0)").text()!=="序号"){$bodyTr.prepend("<th>序号</th>");}$trs=$myBody.find("tr:gt(0)");$.each($trs,function(){++trsIndex;$(this).prepend("<td>"+trsIndex+"</td>");});}}}else{if(this.settings.search.thInThead===true){$(this.settings.search.resultClassName,this.currentTarget).find("> table > tbody").empty().append("<tr><td colspan='15' ><div class='taiji_not_found'>没有检索到符合条件的数据！</div></td></tr>");
}else{$(this.settings.search.resultClassName,this.currentTarget).find("> table > tbody").find("tr:gt(0)").remove().end().append("<tr><td colspan='15' ><div class='taiji_not_found'>没有检索到符合条件的数据！</div></td></tr>");}}}this._bindDataChange();if(this.settings.search.callback&&typeof this.settings.search.callback==="function"){this.settings.search.callback(responseText);}var $$this=this;if(this.searchAutoRefreshEnable===true){if(this.taijiSearchTimeoutId){window.clearTimeout(this.taijiSearchTimeoutId);}this.taijiSearchTimeoutId=window.setTimeout(function(){$($$this.searchSubmitClassName,$$this.currentTarget).triggerHandler("click");},$$this.searchAutoRefreshInterval);}$(this.currentTarget).triggerHandler("taijiSearchSuccess",[responseText]);},_handleOperateError:function(statusCode,obj){var $this=$(obj),showMessage=$.Taiji.Messages.ERR_RESPONSE+statusCode;this._showWarn(showMessage);this.warn(showMessage);$this.attr("disabled",false);this._removeLoading();this.isRunning=false;},_bindCssToggle:function(){$(this.settings.search.resultClassName,this.currentTarget).find("> table > tbody > tr").off("mouseover.taiji").on("mouseover.taiji",function(e){$(this).addClass("taiji_mouseover");
}).off("mouseout.taiji").on("mouseout.taiji",function(e){$(this).removeClass("taiji_mouseover");}).off("click.taiji").on("click.taiji",function(event){$(this).addClass("taiji_clicked").siblings().removeClass("taiji_clicked");});},_bindPager_8:function(){var $this=this;$(".taiji_pager",this.currentTarget).each(function(){$(this).pager({pagenumber:$(this).attr("pageNo"),pagecount:$(this).attr("pagecount"),totalcount:$(this).attr("totalcount"),buttonClickCallback:function(pageclickednumber){$this._handlePageClick(pageclickednumber);}});});},_bindPager_9:function($searchPager){var $this=this,pageNo=window.parseInt($searchPager.find("#taiji_search_pageNo").text(),10),pageCount=window.parseInt($searchPager.find("#taiji_search_pagecount").text(),10),totalCount=window.parseInt($searchPager.find("#taiji_search_totalcount").text(),10);if(isNaN(pageCount)||pageCount<2||isNaN(pageNo)||pageNo<1||isNaN(totalCount)||totalCount<=0){$(".taiji_pager",this.currentTarget).hide();$(".taiji_pager_go",$this.currentTarget).hide();
}else{$(".taiji_pager",this.currentTarget).each(function(){$(this).pager({pagenumber:pageNo,pagecount:pageCount,totalcount:totalCount,buttonClickCallback:function(pageClickedNumber){$this._handlePageClick(pageClickedNumber);}});}).show();$(".taiji_pager_go",$this.currentTarget).show();}},_bindPager:function($searchPager){var $this=this,pageNo=window.parseInt($searchPager.find("#taiji_search_pageNo").text(),10),pageCount=window.parseInt($searchPager.find("#taiji_search_pagecount").text(),10),totalCount=window.parseInt($searchPager.find("#taiji_search_totalcount").text(),10);if(isNaN(pageCount)||pageCount<2||isNaN(pageNo)||pageNo<1||isNaN(totalCount)||totalCount<=0){$(".taiji_pager",this.currentTarget).hide();$(".taiji_pager_go",$this.currentTarget).hide();}else{$(".taiji_pager",this.currentTarget).each(function(){var $ul=$("<ul></ul>");var $li_total_record=$("<li  class='prev disabled'><a >共<label class='totalcount'>"+totalCount+"</label>条/"+pageCount+"页</a></li>").appendTo($ul);var $li_prev=$("<li ><a href='#' class='taiji_pager_item' value='"+(pageNo-1)+"'>&lt;</a></li>").appendTo($ul);
if(pageNo===1){$li_prev.addClass("disabled prev").find("a").removeClass("taiji_pager_item");}var startPoint=1,endPoint=5;if(pageNo>3){startPoint=pageNo-2;endPoint=pageNo+2;}if(endPoint>pageCount){startPoint=pageCount-4;endPoint=pageCount;}if(startPoint<1){startPoint=1;}for(var point=startPoint;point<=endPoint;point++){var $li_point=$("<li ><a href='#' class='taiji_pager_item' value='"+point+"'>"+point+"</a></li>").appendTo($ul);if(point===pageNo){$li_point.addClass("active").find("a").removeClass("taiji_pager_item");}}var $li_next=$("<li ><a href='#' class='taiji_pager_item' value='"+(pageNo+1)+"'>&gt;</a></li>").appendTo($ul);if(pageNo===pageCount){$li_next.addClass("disabled").find("a").removeClass("taiji_pager_item");}$(this).html($ul);}).show();$(".taiji_pager_input",$this.currentTarget).val(pageNo);$(".taiji_pager_go",$this.currentTarget).show();}},_handleSearchError:function(statusCode){this._showWarn($.Taiji.Messages.ERR_RESPONSE+statusCode);this._removeLoading();$(this.searchSubmitClassName,this.currentTarget).attr("disabled",false);
this.isRunning=false;},_createLoading:function(message){this.log("[_createLoading]"+message);var offset=$(this.currentTarget).offset();var len=message.length,width=len*this.$fs+this.$pl*2,x=(this.$windowW-width-offset.left)/2+this.$sw,y=(this.$windowH-offset.top)/3+this.$sh;this.$loadingDiv.css({"width":width,"left":x,"top":y}).text(message).fadeIn(10);},_removeLoading:function(){this.$loadingDiv.fadeOut(10);},_showWarn:function(message){if(typeof message!=="string"){this.warn("[_showWarn] 非字符串无法显示");}this.log("[_showWarn]"+message);var offset=$(this.currentTarget).offset();var len=message.length,width=len*this.$fs+this.$pl*2,x=(this.$windowW-width-offset.left)/2+this.$sw,y=(this.$windowH-offset.top)/3+this.$sh;this.$warnDiv.css({"width":width,"left":x,"top":y}).text(message).fadeIn(500).delay(this.settings.warnShowTime).fadeOut(500);},_showNote:function(message){if(typeof message!=="string"){this.warn("[_showWarn] 非字符串无法显示");}this.log("[_showNote]"+message);var offset=$(this.currentTarget).offset();
var len=message.length,width=len*this.$fs+this.$pl*2,x=(this.$windowW-width-offset.left)/2+this.$sw,y=(this.$windowH-offset.top)/3+this.$sh;this.$noteDiv.css({"width":width,"left":x,"top":y}).text(message).fadeIn(500).delay(this.settings.noteShowTime).fadeOut(500);},getMetaWH:function(element,pluginName){var currentWH=this.nyroModalConf[pluginName],$myMetadata;if($.metadata){$myMetadata=$(element).metadata();$myMetadata.sizes={};if($myMetadata.width){$myMetadata.sizes.minW=$myMetadata.width;}if($myMetadata.height){$myMetadata.sizes.minH=$myMetadata.height;}currentWH=$.extend(true,{},currentWH,$myMetadata);}return currentWH;},aclCheck:function(obj){if(!this.settings.enableAclCheck){return;}var $obj=$(obj);var uris;if($obj.is(this.settings.aclClassName)){uris=$obj;}else{uris=$obj.find(this.settings.aclClassName);}var pathName=window.location.pathname;var rootUrl=pathName.substr(0,pathName.substr(1).indexOf("/")+1)+"/";var hrefs=uris.map(function(){return $(this).attr("href").replace(rootUrl,"");
}).get().join(",");$.ajax({type:"POST",url:rootUrl+"app/acl/hasbuttons",data:"uris="+hrefs,async:false,dataType:"json",success:function(list){$.each(list,function(i,n){if(!n.hasButton){uris.filter("[href='"+rootUrl+n.uri+"']").hide();}});}});},log:function(msg){if(this.settings.debug===true&&window.console&&window.console.warn){window.console.warn(msg);}},warn:function(msg){if(this.settings.debug===true&&window.console&&window.console.log){window.console.log(msg);}},repostion:function(){this.$windowW=$(window).width();this.$windowH=$(window).height();this.$sw=$(document).scrollLeft();this.$sh=$(document).scrollTop();}}});$.extend($.Taiji,{addCustomMethod:function(acustomMethod){$.Taiji.initMethods[acustomMethod.name]=acustomMethod.initMethod;$.Taiji.afterSearchMethods[acustomMethod.name]=acustomMethod.afterSearchMethod;$.Taiji.defaults[acustomMethod.name]=acustomMethod.defaults;},initMethods:{},afterSearchMethods:{},extendMethod:function(aExtendMethod){$.Taiji.defaults[aExtendMethod.name]=aExtendMethod.config;
if(aExtendMethod.userNyroModal===true){$.Taiji.useNyroModals.push(aExtendMethod.name);}$.each(aExtendMethod.event,function(event,coll){if(!$.Taiji.events[event]){$.Taiji.events[event]={};}if(!$.Taiji.events[event][aExtendMethod.name]){$.Taiji.events[event][aExtendMethod.name]={};}if(coll){$.each(coll,function(className,handler){$.Taiji.log("事件："+event+",插件："+aExtendMethod.name+"，class:"+className+",处理函数:"+handler);$.Taiji.events[event][aExtendMethod.name][className]=handler;});}});if(aExtendMethod.customEvent){$.each(aExtendMethod.customEvent,function(i,event){$.Taiji.customEvents[i]=event;});}$.each(aExtendMethod.eventHandler,function(i,handler){$.Taiji.prototype[i]=handler;});},events:{},eventsSubject:{},customEvents:{},useNyroModals:[],Constans:{RESPONSE_HEADER_NOTE:"taiji_note",RESPONSE_HEADER_JME:"taiji_jme",RESPONSE_HEADER_ME:"taiji_me",RESPONSE_HEADER_CVE:"taiji_cve"},preventDefault:function(event){if(event.preventDefault){event.preventDefault();}else{event.returnValue=false;}},Messages:{ERR_CVE:"校验失败，请看相关字段提示!",ERR_RESPONSE:"服务器返回了非预期的值，请联系技术人员，代码:",WAR_NOTNODE:"未选中任何节点！",WAR_OPERATE:"前一次操作尚未完成，请稍候！",MSG_OPERATE:"操作进行中，请稍候！"},getUrl:function(obj){var $obj=$(obj);
return $obj&&$obj.is("a")&&$obj.attr("href");},getMetaWH:function(element,currentWH){if($.metadata){var $metadata=$(element).metadata();$metadata.sizes={};if($metadata.width){$metadata.sizes.minW=$metadata.width;}if($metadata.height){$metadata.sizes.minH=$metadata.height;}currentWH=$.extend(true,{},currentWH,$metadata);}return currentWH;},getConfirmMessage:function(obj){var $obj=$(obj);return $.metadata&&$obj.metadata().confirm_message?$obj.metadata().confirm_message:$obj.attr("confirm_message");},hasCustomForm:function(obj){var $obj=$(obj);return $.metadata&&$obj.metadata().custom_form;},createCustomForm:function(obj){var $obj=$(obj);var url=this.getUrl(obj);var ids=$obj.metadata().custom_form;var createForm=$("<form>",{name:"myCustomForm",action:url,method:"post"}).append($(ids).clone().removeAttr("id")).appendTo(document.body).hide();return createForm;},log:function(msg){if(window.console&&window.console.log){window.console.log(msg);}},defaults:{search:{formClassName:".taiji_search_form",rules:{},messages:{},submitClassName:".taiji_search_submit",resetClassName:".taiji_search_reset",resultClassName:".taiji_search_result",dataClassName:".taiji_search_data",pagerClassName:".taiji_search_pager",callback:function(){},autoRefresh:{enable:false,interval:60000},autoSearch:true,thInThead:false,autoAddOrder:false},width:640,height:480,stack:true,closeOnClick:true,noteShowTime:2000,warnShowTime:2000,errorElement:"label",errorClass:"taiji_error",aclClassName:".taiji_acl",enableAclCheck:false,debug:true}});
$.Taiji.base64=new Base64();})(jQuery,window,document);(function($){$.Taiji.extendMethod({name:"pager",event:{click:{"className":"_handlePagerClick","gotoClassName":"_handleGotoClick"}},userNyroModal:false,eventHandler:{_handlePagerClick:function(element){var pageclickednumber=$(element).attr("value");this._handlePageClick(pageclickednumber);},_handlePageClick:function(pageclickednumber){var $pageNo=$("input[name='pageNo']",this.currentTarget);if($pageNo.attr("name")){$pageNo.val(pageclickednumber);}else{$pageNo=$("<input type='hidden' id='pageNo' name='pageNo'/>").val(pageclickednumber).appendTo($(this.searchFormClassName,this.currentTarget));}$(this.searchFormClassName,this.currentTarget).trigger("submit");},_handleGotoClick:function(element){var $ele=$(element);var $pageNo=$ele.parent().find(".taiji_pager_input");if($pageNo.is(".taiji_pager_input")){var clickValue=$.trim($pageNo.val());if(!clickValue){this._showWarn("请填写跳转页数");return;}if(!/^\d+$/.test(clickValue)){this._showWarn("请填写数字");
return;}var pageclickednumber=parseInt(clickValue,10);if(pageclickednumber>100000){this._showWarn("页数太大，请重新填写");return;}this._handlePageClick(pageclickednumber);}else{this.warn("没有name为pageNo的input框");}}},config:{className:".taiji_pager_item",gotoClassName:".taiji_pager_goto"}});})(jQuery);(function($){$.Taiji.extendMethod({name:"multiCore",event:{change:{"checkAll":"_handleMultiCoreCheckAll"}},userNyroModal:false,eventHandler:{_handleMultiCoreCheckAll:function(element){if($(element).is(":checked")){$(this.settings.multiCore.checkAll,this.currentTarget).attr("checked",true);$(this.settings.multiCore.checkOne,this.currentTarget).attr("checked",true);}else{$(this.settings.multiCore.checkAll,this.currentTarget).attr("checked",false);$(this.settings.multiCore.checkOne,this.currentTarget).attr("checked",false);}}},config:{checkAll:".taiji_check_all",checkOne:".taiji_check_one"}});})(jQuery);(function($){$.Taiji.extendMethod({name:"add",event:{click:{"className":"_handleAddClick"}},userNyroModal:true,customEvent:{"taijiAddPost":"_handleAddPost"},eventHandler:{_handleAddClick:function(element){if(this.isRunning===true){this.warn($.Taiji.Messages.WAR_OPERATE);
return;}else{this.isRunning=true;}var $this=$(element),$metacurrent=this.getMetaWH($this,"add");if($.Taiji.hasCustomForm(element)){var customForm=$.Taiji.createCustomForm(element);customForm.nm($metacurrent);customForm.submit();customForm.remove();}else{$.nmManual($this.attr("href"),$metacurrent);}},_bindAdd:function(){var $$this=this;$(this.settings.add.className,this.currentTarget).off("click.taiji").on("click.taiji",function(event){$$this._handleAddClick(this);$.Taiji.preventDefault(event);});},_bindAddPost:function(){var $self=this;$(this.currentTarget).off("taijiAddPost").on("taijiAddPost",function(event,form,options){$self._handleAddPost(form,options);});},_handleAddPost:function(form,options){this._createLoading($.Taiji.Messages.MSG_OPERATE);var $$this=this,$form=$(form),settings={success:function(data,status,xhr){var responseHeader={note:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_NOTE),jme:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_JME),me:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_ME),cve:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_CVE)};
$$this._handleAddSuccess(xhr.status,responseHeader,data,$form);$(":file",$form).each(function(){$(this).attr("disabled",false);});},error:function(xhr){$$this._handleAddError(xhr.status);$(":file",$form).each(function(){$(this).attr("disabled",false);});},dataType:"html",forceSync:true};$.extend(settings,options);var $files=$(":file",$form);if($files.size()===0){$(form).removeProp("enctype");}else{var filesSize=$files.size();$files.each(function(){if(!$(this).val()){filesSize--;$(this).attr("disabled",true);}});if(filesSize===0){$(form).removeProp("enctype");}else{$(form).prop("enctype","multipart/form-data");}}$(form).ajaxSubmit(settings);$(":file",$form).each(function(){$(this).attr("disabled",false);});},_handleAddError:function(statusCode){this._removeLoading();this._showWarn($.Taiji.Messages.ERR_RESPONSE+statusCode);this.isRunnig=false;},_handleAddSuccess:function(statusCode,responseHeader,responseText,$form){this._removeLoading();if(responseHeader.note){this._handleAddSuccessOK(responseText,this.decode(responseHeader.note));
}else{if(responseHeader.jme){this._showWarn(this.decode(responseHeader.jme));}else{if(responseHeader.me){this._showWarn(this.decode(responseHeader.me));}else{if(responseHeader.cve){var ejson=$(responseText).find("#taiji_ejson"),$$this=this;var ejsonContent=$.parseJSON($(ejson).html());$.each(ejsonContent,function(i,n){$("[name='"+i+"']",$form).remind(n);});this._showWarn($.Taiji.Messages.ERR_CVE);}else{if($(responseText).is("div")){var $taijiNote=$(responseText).find("#taiji_note");if($taijiNote.is("#taiji_note")){this._handleAddSuccessOK(responseText,$taijiNote.text());}else{this.warn($.Taiji.Messages.ERR_RESPONSE,statusCode);this._showWarn($.Taiji.Messages.ERR_RESPONSE,statusCode);}}else{this.warn($.Taiji.Messages.ERR_RESPONSE,statusCode);this._showWarn($.Taiji.Messages.ERR_RESPONSE,statusCode);}}}}}this.isRunning=false;},_handleAddSuccessOK:function(responseText,note){var $row1=$(responseText).find(".taiji_result_data tr").addClass("taiji_clicked");this.aclCheck($row1);var $tbody=$(this.settings.search.resultClassName,this.currentTarget).find("> table > tbody");
$tbody.find(".taiji_clicked").removeClass("taiji_clicked");if($tbody.children().size()===0){$tbody.append($row1);}else{var $firstTr=$tbody.find(">tr:first");if($firstTr.children().is("th")){$firstTr.after($row1);}else{if($firstTr.children().is("td")){$firstTr.before($row1);}}}this._bindDataChange();$(".taiji_pager .totalcount",this.currentTarget).each(function(){$(this).text(parseInt($(this).text(),10)+1);});this._showNote(note);if($.nmTop&&$.nmTop()){$.nmTop().close();}if(this.settings.add.callback&&typeof this.settings.add.callback==="function"){this.settings.add.callback(responseText);}$(this.currentTarget).triggerHandler("taijiAddSuccess",[responseText]);}},config:{className:".taiji_add",callback:function(){}}});var http=/^http:\/\//;$.extend({taijiAddSubmit:function(form,option){var nmT=$.nmTop().opener[0].toString();if(http.test(nmT)){nmT=nmT.substr(7);var index=nmT.indexOf("/");nmT=nmT.substr(index);}$("a[href$='"+nmT+"']").parents("._taiji_").data("aTaiji")._handleAddPost(form,option);
}});})(jQuery);(function($){$.extend({autocompleteAll:function(){var alls=$(".taiji_autocomplete:visible:not(._taiji_autocomplete)"),remotes=[],locals=[];$(alls).each(function(){if($(this).is("[data-url]")){remotes.push($(this));}else{locals.push($(this));}});$.autocompleteRemote(remotes);$.autocompleteLocal(locals);},autocompleteRemote:function(elems){$(elems).each(function(){var url=$(this).attr("data-url");var that=$(this);var key=that.attr("name");that.ajaxChosen({type:"POST",url:url,dataType:"json",minTermLength:1,afterTypeDelay:1000,jsonTermKey:key},function(data){var terms={};$.each(data,function(i,val){terms[val.id]=val.label;});return terms;}).addClass("_taiji_autocomplete");});},autocompleteLocal:function(elems){$(elems).each(function(){$(this).chosen({no_results_text:"没有匹配的选项!",search_contains:true}).addClass("_taiji_autocomplete");});}});})(jQuery);jQuery(function(){jQuery.autocompleteAll();});(function($){$.Taiji.extendMethod({name:"download",event:{click:{"className":"_handleDownloadClick"}},userNyroModal:false,eventHandler:{_handleDownloadClick:function(elment){var $this=$(elment);
var $url=$.Taiji.getUrl($this);if(!$url){this.warn($.Taiji.Messages.ERR_URL);return;}if(this.isRunning===true){this.warn($.Taiji.Messages.WAR_OPERATE);return;}else{this.isRunning=true;}$this.attr("disabled",true);this._createLoading($.Taiji.Messages.MSG_OPERATE);var $$this=this;var options={url:$url,type:"POST",dataType:"html",success:function(responseText,status,xhr){$$this.isRunning=false;if(xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_NOTE)){window.open($url);}else{if(xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_JME)){$$this._showWarn($$this.decode(xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_JME)));}else{if(xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_ME)){$$this._showWarn($$this.decode(xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_ME)));}else{if(xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_CVE)){$$this._showWarn($$this.decode(xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_CVE)));}else{$$this.warn($.Taiji.Messages.ERR_RESPONSE,xhr.status);
$$this._showWarn($.Taiji.Messages.ERR_RESPONSE,xhr.status);}}}}$$this._removeLoading();$this.attr("disabled",false);},error:function(xhr){$$this._handleOperateError(xhr.status,$this);}};$.ajax(options);},_bindDownload:function(){var $$this=this;$(this.settings.download.className,this.currentTarget).off("click.taiji").on("click.taiji",function(){$$this._handleDownloadClick(this);});}},config:{className:".taiji_download",callback:function(){}}});})(jQuery);(function($){$.Taiji.extendMethod({name:"edit",event:{click:{"className":"_handleEditClick"}},userNyroModal:true,customEvent:{"taijiEditPost":"_handleEditPost"},eventHandler:{_handleEditClick:function(element){if(this.isRunning===true){this.warn($.Taiji.Messages.WAR_OPERATE);return;}else{this.isRunning=true;}var $this=$(element);var $metacurrent=this.getMetaWH($this,"edit");$.nmManual($this.attr("href"),$metacurrent);},_bindEdit:function(){var $$this=this;$(this.settings.edit.className,this.currentTarget).off("click.taiji").on("click.taiji",function(){$$this._handleEditClick(this);
});},_bindEditPost:function(){var $self=this;$(this.currentTarget).off("taijiEditPost").on("taijiEditPost",function(event,form,options){$self._handleEditPost(form,options);});},_handleEditPost:function(form,options){this._createLoading($.Taiji.Messages.MSG_OPERATE);var $$this=this;var $form=$(form);var settings={success:function(data,status,xhr){var responseHeader={note:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_NOTE),jme:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_JME),me:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_ME),cve:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_CVE)};$$this._handleEditSuccess(xhr.status,responseHeader,data,$form);},error:function(xhr){$$this._handleEditError(xhr.status);}};$.extend(settings,options);var $files=$(":file",$form);if($files.size()===0){$(form).removeProp("enctype");}else{var filesSize=$files.size();$files.each(function(){if(!$(this).val()){filesSize--;$(this).attr("disabled",true);}});if(filesSize===0){$(form).removeProp("enctype");
}else{$(form).prop("enctype","multipart/form-data");}}$(form).ajaxSubmit(settings);$(":file",$form).each(function(){$(this).attr("disabled",false);});},_handleEditError:function(statusCode){this._removeLoading();this._showWarn($.Taiji.Messages.ERR_RESPONSE+statusCode);this.isRunning=false;},_handleEditSuccess:function(statusCode,responseHeader,responseText,$form){this._removeLoading();if(responseHeader.note){this._handleEditSuccessOK(responseText,this.decode(responseHeader.note));}else{if(responseHeader.jme){this._showWarn(this.decode(responseHeader.jme));}else{if(responseHeader.me){this._showWarn(this.decode(responseHeader.me));}else{if(responseHeader.cve){var ejson=$(responseText).find("#taiji_ejson");var ejsonContent=$.parseJSON($(ejson).html());var $$this=this;$.each(ejsonContent,function(i,n){$("[name='"+i+"']",$form).remind(n);});this._showWarn($.Taiji.Messages.ERR_CVE);}else{if($(responseText).is("div")){var $taijiNote=$(responseText).find("#taiji_note");if($taijiNote.is("#taiji_note")){this._handleEditSuccessOK(responseText,$taijiNote.text());
}else{this.warn($.Taiji.Messages.ERR_RESPONSE,statusCode);this._showWarn($.Taiji.Messages.ERR_RESPONSE,statusCode);}}else{this.warn($.Taiji.Messages.ERR_RESPONSE,statusCode);this._showWarn($.Taiji.Messages.ERR_RESPONSE,statusCode);}}}}}this.isRunning=false;},_handleEditSuccessOK:function(responseText,note){var $row=$(responseText).find(".taiji_result_data tr");this.aclCheck($row);$(this.settings.search.resultClassName,this.currentTarget).find(".taiji_clicked").replaceWith($row.addClass("taiji_clicked"));this._bindDataChange();this._showNote(note);if($.nmTop&&$.nmTop()){$.nmTop().close();}if(this.settings.edit.callback&&typeof this.settings.edit.callback){this.settings.edit.callback(responseText);}$(this.currentTarget).triggerHandler("taijiEditSuccess",[responseText]);}},config:{className:".taiji_edit",callback:function(){}}});var http=/^http:\/\//;$.extend({taijiEditSubmit:function(form,option){var nmT=$.nmTop().opener[0].toString();if(http.test(nmT)){nmT=nmT.substr(7);var index=nmT.indexOf("/");
nmT=nmT.substr(index);}$("a[href$='"+nmT+"']").parents("._taiji_").data("aTaiji")._handleEditPost(form,option);}});})(jQuery);(function($){$.Taiji.extendMethod({name:"exported",event:{click:{"className":"_handleExportedClick"}},userNyroModal:false,eventHandler:{_handleExportedClick:function(element){var $$this=this;var $this=$(element);var $url=$.Taiji.getUrl($this);if(!$url){this.warn("没有找到导出的URL..");return;}var query="";$(this.settings.search.formClassName,$$this.currentTarget).find(":input").each(function(){query+=$(this).attr("name");query+="=";query+=$(this).val();query+="&";});$(this.settings.search.formClassName,$$this.currentTarget).find(":selected").each(function(){query+=$(this).attr("name");query+="=";query+=$(this).val();query+="&";});if($url.indexOf("?")>-1){query="&"+query;}else{query="?"+query;}$url+=encodeURI(query);if(this.isRunning===true){this.warn($.Taiji.Messages.WAR_OPERATE);return false;}else{$$this.isRunning=true;}$this.attr("disabled",true);this._createLoading($.Taiji.Messages.MSG_OPERATE);
$.ajax({url:$url,type:"GET",dataType:"html",success:function(responseText,status,xhr){var responseHeader={note:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_NOTE),jme:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_JME),me:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_ME),cve:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_CVE)};$$this._handleExportedSuccess(xhr.status,responseHeader,responseText,$this,$url);},error:function(xhr){$$this._handleOperateError(xhr.status,$this);}});},_handleExportedSuccess:function(status,responseHeader,responseText,obj,url){var $this=$(obj);$this.attr("disabled",false);this._removeLoading();if(responseHeader.note){window.open(url,"_self");}else{if(responseHeader.jme){this._showWarn(this.decode(responseHeader.jme));}else{if(responseHeader.me){this._showWarn(this.decode(responseHeader.me));}else{if(responseHeader.cve){this._showWarn(this.decode(responseHeader.cve));}else{this.warn("服务器返回了非预期的值，请联系开发人员进行处理！,代码:",status);this._showWarn("服务器返回了非预期的值，请联系开发人员进行处理！,代码:",status);
}}}}this.isRunning=false;}},config:{className:".taiji_exported",includeAll:false,includeFields:[],rules:{}}});})(jQuery);(function($){$.extend($.Taiji,{taijiJump:function(form,button,options){var $button=$(button);$.holdReady(true);$button.attr("disabled",true);$.Taiji.createLoading($.Taiji.Messages.MSG_OPERATE);var $form=$(form),settings={success:function(data,status,xhr){var responseHeader={note:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_NOTE),jme:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_JME),me:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_ME),cve:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_CVE)};$.Taiji.removeLoading();if(responseHeader.note){$.Taiji.showNote($.Taiji.base64.decode(responseHeader.note));var noteHead=$("head")[0];var si=data.indexOf("<script");var sdd=data.substr(si);var siii=data.indexOf(">",si);var ei=data.indexOf("</",siii);var sd=data.substr(siii+1,ei-siii-1);var noteScript=document.createElement("script");noteHead.appendChild(noteScript);
noteScript.innerHTML=sd;}else{if(responseHeader.jme){$.Taiji.showWarn($.Taiji.base64.decode(responseHeader.jme));}else{if(responseHeader.me){$.Taiji.showWarn($.Taiji.base64.decode(responseHeader.me));}else{if(responseHeader.cve){var ejson=$(data).find("#taiji_ejson");var ejsonContent=$.parseJSON($(ejson).html());$("[generated=true]",$form).each(function(){$(this).html("");});$.each(ejsonContent,function(i,n){var $nextLabel=$("[for="+i+"]");if($nextLabel.hasClass($.Taiji.defaults.errorClass)){$nextLabel.text(n);$nextLabel.show();}else{$nextLabel=$("<label></label>");$nextLabel.addClass($.Taiji.defaults.errorClass);$nextLabel.attr({"for":i,generated:true});$nextLabel.text(n);$("[name="+i+"]",$form).after($nextLabel);}});$.Taiji.showWarn($.Taiji.Messages.ERR_CVE);}else{if(xhr.status===200){var headStart=-1,headEnd=-1,head=$("head").html("")[0],tagList=["src","defer","language","type"],scriptStart=-1,tagIndex=-1,scriptEnd=-1,tagListLength=tagList.length,scriptText=[],scriptSrcText=[],aText,aAtt;
while(data.indexOf("<script")>-1){scriptStart=data.indexOf("<script");tagIndex=data.indexOf(">");scriptEnd=data.indexOf("<\/script");var temp=data.substr(scriptStart,tagIndex);if(temp.indexOf("src")>0){scriptSrcText.push(data.substr(scriptStart,scriptEnd-scriptStart+9));}else{scriptText.push(data.substr(scriptStart,scriptEnd-scriptStart+9));}data=data.substr(0,scriptStart)+data.substr(scriptEnd+9);}var tagLength,start,end,text;while(data.indexOf("<head")>0){headStart=data.indexOf("<head");headEnd=data.indexOf("</head");var headHtml=data.substr(headStart,headEnd-headStart+7);$("head").append($(headHtml));data=data.substr(0,headStart)+data.substr(headEnd+7);}$("body").html(data);window.setTimeout(function(){for(var a=0;a<scriptText.length;a++){aText=scriptText[a];tagIndex=aText.indexOf(">");aAtt=aText.substr(0,tagIndex);var aScript=document.createElement("script");aScript.type="text/javascript";head.appendChild(aScript);for(var i=0;i<tagListLength;i++){tagLength=tagList[i].length+1;if(aAtt.indexOf(tagList[i]+"=")>-1){start=aAtt.indexOf(tagList[i]+"=");
end=aAtt.indexOf(aAtt.charAt(start+tagLength),start+tagLength+2);text=aAtt.substr(start+tagLength+1,end-start-tagLength-1);aScript[tagList[i]]=text;}}if(aText.length>tagIndex+1){aScript.text=aText.substr(tagIndex+1,aText.length-tagIndex-10);}}},100);}else{$.Taiji.showWarn($.Taiji.Messages.ERR_RESPONSE+xhr.status);}}}}}$button.attr("disabled",false);},error:function(xhr){$.Taiji.removeLoading();$.Taiji.showWarn($.Taiji.Messages.ERR_RESPONSE+xhr.status);$button.attr("disabled",false);},dataType:"html",forceSync:true};$.extend(settings,options);$(form).ajaxSubmit(settings);},createLoading:function(){},showNote:function(message){},showWarn:function(message){},removeLoading:function(){}});})(jQuery);(function($){$.fn.menu=function(){var windowWidth=$(".nav_mid").width()-10;var hidable=false;var $lis=$(".menu > li");var $now=$lis.find("> a.now").parent();var totalCount=$lis.size();var totalWidth=0;var allWidth=[];$lis.each(function(i,n){totalWidth+=$(this).width();allWidth[i]=$(this).width();
});var firstShowIndex=0,lastShowIndex=totalCount,theWidth=0;function nextAll(){for(var i=1;i<totalCount;i++){var temp=theWidth+allWidth[i];if(temp<windowWidth){theWidth+=allWidth[i];lastShowIndex=i;$lis.eq(i).show();}else{break;}}$(".nav_right").addClass("nav_more");}function prevAll(){for(var j=totalCount-2;j>=0;j--){var temp=theWidth+allWidth[j];if(temp<windowWidth){theWidth+=allWidth[j];firstShowIndex=j;$lis.eq(j).show();}else{break;}}$(".nav_left").addClass("nav_more");}function siblingAll(index){var next=false,nextIndex=index,prevIndex=index;for(var z=0;z<totalCount*2;z++){if(next===true){++nextIndex;if(nextIndex<totalCount){var temp=theWidth+allWidth[nextIndex];if(temp<windowWidth){theWidth+=allWidth[nextIndex];lastShowIndex=nextIndex;$lis.eq(nextIndex).show();}else{break;}}next=false;}else{if(next===false){--prevIndex;if(prevIndex>=0){var temp1=theWidth+allWidth[prevIndex];if(temp1<windowWidth){theWidth+=allWidth[prevIndex];firstShowIndex=prevIndex;$lis.eq(prevIndex).show();}else{break;
}}next=true;}}}if(lastShowIndex<totalCount){$(".nav_right").addClass("nav_more");}if(firstShowIndex>0){$(".nav_left").addClass("nav_more");}}function init(){windowWidth=$(".nav_mid").width()-10;$now=$lis.find("> a.now").parent();if(totalWidth<windowWidth){$lis.show();return;}$lis.hide();$now.show();theWidth=$now.width();hidable=true;var index=$lis.index($now),firstShowIndex=index,lastShowIndex=index;if(index===0){nextAll();}else{if(index===totalCount-1){prevAll();}else{siblingAll(index);}}}$(window).on("resize",init);$(".nav_left").on("click",function(){if(hidable===false){return false;}else{if(firstShowIndex===0){return false;}}theWidth+=allWidth[--firstShowIndex];if(theWidth>windowWidth){theWidth-=$lis.eq(lastShowIndex--).hide().width();if(theWidth>windowWidth){theWidth-=$lis.eq(lastShowIndex--).hide().width();}}$lis.eq(firstShowIndex).fadeIn(1000);if(lastShowIndex<totalCount-1){$(".nav_right").addClass("nav_more");}else{$(".nav_right").removeClass("nav_more");}if(firstShowIndex>0){$(".nav_left").addClass("nav_more");
}else{$(".nav_left").removeClass("nav_more");}return false;});$(".nav_right").on("click",function(){if(hidable===false){return false;}else{if(lastShowIndex===totalCount-1){return false;}}theWidth+=allWidth[++lastShowIndex];if(theWidth>windowWidth){theWidth-=$lis.eq(firstShowIndex++).hide().width();if(theWidth>windowWidth){theWidth-=$lis.eq(firstShowIndex++).hide().width();}}$lis.eq(lastShowIndex).fadeIn(1000);if(lastShowIndex<totalCount-1){$(".nav_right").addClass("nav_more");}else{$(".nav_right").removeClass("nav_more");}if(firstShowIndex>0){$(".nav_left").addClass("nav_more");}else{$(".nav_left").removeClass("nav_more");}return false;});return init();};})(jQuery);jQuery(function(){jQuery(".nav").menu();});(function($){$.Taiji.extendMethod({name:"multiOperate",event:{click:{"className":"_handleMultiOperateClick"}},userNyroModal:false,eventHandler:{_handleMultiOperateClick:function(element){var $$this=this;var $this=$(element);var $url=$.Taiji.getUrl($this);if(!$url){$$this.warn("没有找到批量删除的URL..");
return false;}if(!this.settings.multiCore.checkOne){$$this.warn("未设定checkbox的class");return false;}var $checkedList=$(this.settings.multiCore.checkOne+":checked");if($checkedList.size()===0){$$this.warn("未选中任何项");$$this._showWarn("请至少选中一个操作项");return false;}var $message=$.Taiji.getConfirmMessage($this);if($message){if(!window.confirm($message)){return false;}}if($$this.isRunning===true){$$this.warn("前一次<"+$$this.running+">操作尚未结束，当前multiOperate操作被禁止！");return false;}else{$$this.isRunning=true;}$this.attr("disabled",true);$$this._createLoading("批量操作操作进行中，请稍等");var dataA="";var theCheckboxName=$checkedList.attr("name");$checkedList.each(function(){dataA+=theCheckboxName;dataA+="=";dataA+=$(this).val();dataA+="&";});if(dataA.length>1){dataA=dataA.substr(0,dataA.length-1);}$.ajax({url:$url,type:"POST",data:dataA,dataType:"html",success:function(responseText,status,xhr){var responseHeader={note:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_NOTE),jme:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_JME),me:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_ME),cve:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_CVE)};
$$this._handleMultiOperateSuccess(xhr.status,responseHeader,responseText,$this);},error:function(xhr){$$this._handleOperateError(xhr.status,$this);}});},_handleMultiOperateSuccess:function(status,responseHeader,responseText,obj){var $this=$(obj);$this.attr("disabled",false);this._removeLoading();this.isRunning=false;if(responseHeader.note){this._showNote(this.decode(responseHeader.note));if(this.settings.multiOperate.callback&&typeof this.settings.multiOperate.callback==="function"){this.settings.multiOperate.callback(responseText);}$(this.currentTarget).trigger("taijiMultiOperateSuccess",[responseText]);}else{if(responseHeader.jme){this._showWarn(this.decode(responseHeader.jme));}else{if(responseHeader.me){this._showWarn(this.decode(responseHeader.me));}else{if(responseHeader.cve){this._showWarn(this.decode(responseHeader.cve));}else{this.warn("服务器返回了非预期的值，请联系开发人员进行处理！,代码:",status);this._showWarn("服务器返回了非预期的值，请联系开发人员进行处理！,代码:",status);}}}}}},afterSearchMethod:function(){var $$this=this;
$(this.settings.multiOperate.checkAllClassName,this.currentTarget).off("change.taiji").on("change.taiji",function(event){if($(this).is(":checked")){$(":input[name="+$$this.settings.multiOperate.checkboxName+"]",$$this.currentTarget).attr("checked",true);$($$this.settings.multiOperate.checkAllClassName,$$this.currentTarget).attr("checked",true);}else{$(":input[name="+$$this.settings.multiOperate.checkboxName+"]",$$this.currentTarget).attr("checked",false);$($$this.settings.multiOperate.checkAllClassName,$$this.currentTarget).attr("checked",false);}$.Taiji.preventDefault(event);});},config:{className:".taiji_multiOperate",callback:function(){}}});})(jQuery);(function($){$.Taiji.extendMethod({name:"multiRemove",event:{click:{"className":"_handleMultiRemoveClick"}},userNyroModal:false,eventHandler:{_handleMultiRemoveClick:function(element){var $$this=this;var $this=$(element);var $url=$.Taiji.getUrl($this);if(!$url){$$this.warn("没有找到批量删除的URL..");return false;}if(!this.settings.multiCore.checkOne){$$this.warn("未设定checkbox的class");
return false;}var $checkedList=$(this.settings.multiCore.checkOne+":checked");if($checkedList.size()===0){$$this.warn("未选中任何项");$$this._showWarn("请至少选中一个操作项");return false;}var $message=$.Taiji.getConfirmMessage($this);if($message){if(!window.confirm($message)){return false;}}if(this.isRunning===true){this.warn($.Taiji.Messages.WAR_OPERATE);return false;}else{this.isRunning=true;}$this.attr("disabled",true);this._createLoading("批量删除操作进行中，请稍等");var dataA="";var theCheckboxName=$checkedList.attr("name");$checkedList.each(function(){dataA+=theCheckboxName;dataA+="=";dataA+=$(this).val();dataA+="&";});if(dataA.length>1){dataA=dataA.substr(0,dataA.length-1);}$.ajax({url:$url,type:"POST",data:dataA,dataType:"html",success:function(responseText,status,xhr){var responseHeader={note:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_NOTE),jme:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_JME),me:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_ME),cve:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_CVE)};
$$this._handleMultiRemoveSuccess(xhr.status,responseHeader,responseText,$this);},error:function(xhr){$$this._handleOperateError(xhr.status,$this);}});},_handleMultiRemoveSuccess:function(status,responseHeader,responseText,obj){var $this=$(obj);$this.attr("disabled",false);this._removeLoading();this.isRunning=false;if(responseHeader.note){var $checkedList=$(this.settings.multiCore.checkOne+":checked");var $size=$checkedList.size();$checkedList.each(function(i,v){$(this).parents("tr").remove();});$(".taiji_pager .totalcount",this.currentTarget).each(function(){$(this).text(parseInt($(this).text(),10)-$size);});this._showNote(this.decode(responseHeader.note));if(this.settings.multiRemove.callback&&typeof this.settings.multiRemove.callback==="function"){this.settings.multiRemove.callback(responseText);}$(this.currentTarget).trigger("taijiMultiRemoveSuccess",[responseText]);}else{if(responseHeader.jme){this._showWarn(this.decode(responseHeader.jme));}else{if(responseHeader.me){this._showWarn(this.decode(responseHeader.me));
}else{if(responseHeader.cve){this._showWarn(this.decode(responseHeader.cve));}else{this.warn("服务器返回了非预期的值，请联系开发人员进行处理！,代码:",status);this._showWarn("服务器返回了非预期的值，请联系开发人员进行处理！,代码:",status);}}}}}},config:{className:".taiji_multiRemove",callback:function(){}}});})(jQuery);(function($){$.Taiji.extendMethod({name:"operate",event:{click:{"className":"_handleOperateClick"}},userNyroModal:false,eventHandler:{_handleOperateSuccess:function(statusCode,responseHeader,responseText,obj){var $this=$(obj);$this.attr("disabled",false);this._removeLoading();this.isRunning=false;if(responseHeader.note){if(this.settings.operate.callback&&typeof this.settings.operate.callback==="function"){this.settings.operate.callback(responseText);}$(this.currentTarget).triggerHandler("taijiOperateSuccess",[responseText]);this._showNote(this.decode(responseHeader.note));}else{if(responseHeader.jme){this._showWarn(this.decode(responseHeader.jme));}else{if(responseHeader.me){this._showWarn(this.decode(responseHeader.me));}else{if(responseHeader.cve){this._showWarn(this.decode(responseHeader.cve));
}else{this.warn($.Taiji.Messages.ERR_RESPONSE+statusCode);this._showWarn($.Taiji.Messages.ERR_RESPONSE+statusCode);}}}}},_handleOperateClick:function(element){var $this=$(element);var $url=$.Taiji.getUrl($this);if(!$url){this.warn($.Taiji.Messages.ERR_URL);return;}var $message=$.Taiji.getConfirmMessage($this);if($message){if(!window.confirm($message)){return false;}}if(this.isRunning===true){this.warn($.Taiji.Messages.WAR_OPERATE);return;}else{this.isRunning=true;}$this.attr("disabled",true);this._createLoading($.Taiji.Messages.MSG_OPERATE);var $$this=this;var options={url:$url,type:"POST",dataType:"html",success:function(responseText,status,xhr){var responseHeader={note:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_NOTE),jme:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_JME),me:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_ME),cve:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_CVE)};$$this._handleOperateSuccess(xhr.status,responseHeader,responseText,$this);
},error:function(xhr){$$this._handleOperateError(xhr.status,$this);}};$.ajax(options);},_bindOperate:function(){var $$this=this;$(this.settings.operate.className,this.currentTarget).off("click.taiji").on("click.taiji",function(event){$$this._handleOperateClick(this);});}},config:{className:".taiji_operate",callback:function(){}}});})(jQuery);(function($){$.extend({isSupportPlaceholder:(function(){return"placeholder" in document.createElement("input");})(),placeholderAll:function(){var inputs=$("input[placeholder]:visible");$.placeholder(inputs);var areas=$("textarea[placeholder]:visible");$.placeholder(areas);},placeholder:function(elems){if($.isSupportPlaceholder){return;}$(elems).each(function(){if($(this).is("[placeholder]")){var $offset=$(this).offset(),paddingLeft=$.getInt($(this).css("paddingLeft"))+$.getInt($offset.left)+2+"px",paddingTop=$.getInt($(this).css("paddingTop"))+$.getInt($offset.top)+2+"px",placeValue=$(this).attr("placeholder"),zindex=$(this).css("zIndex");var $span=$("<span class='taiji_placeholder'></span>").text(placeValue).css({left:paddingLeft,top:paddingTop});
$("body").after($span);var that=$(this);$span.on("click",function(){that.focus();});$(this).on("propertychange",function(){if($.trim($(that).val())===""){$span.show();}else{$span.hide();}}).addClass("_taiji_placeholder");}});},getInt:function(str){return window.parseInt(str,10);}});})(jQuery);jQuery(function(){jQuery.placeholderAll();});(function($){$.Taiji.extendMethod({name:"popupRemove",event:{click:{"className":"_handlePopupRemoveClick"}},userNyroModal:true,customEvent:{"taijiPopupRemovePost":"_handlePopupRemovePost"},eventHandler:{_handlePopupRemoveClick:function(element){if(this.isRunning===true){this.warn($.Taiji.Messages.WAR_OPERATE);return;}else{this.isRunning=true;}var $this=$(element);var $metacurrent=this.getMetaWH($this,"popupRemove");$.nmManual($this.attr("href"),$metacurrent);},_bindPopupRemovePost:function(){var $self=this;$(this.currentTarget).off("taijiPopupRemovePost").on("taijiPopupRemovePost",function(event,form,options){$self._handlePopupRemovePost(form,options);});
},_bindPopupRemove:function(){var $$this=this;$(this.settings.popupRemove.className,this.currentTarget).off("click.taiji").on("click.taiji",function(){$$this._handlePopupRemoveClick(this);});},_handlePopupRemovePost:function(form,options){this._createLoading($.Taiji.Messages.MSG_OPERATE);var $$this=this;var $form=$(form);var settings={success:function(data,status,xhr){var responseHeader={note:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_NOTE),jme:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_JME),me:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_ME),cve:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_CVE)};$$this._handlePopupRemoveSuccess(xhr.status,responseHeader,data,$form);},error:function(xhr){$$this._hanlePopupRemoveError(xhr.status);},dataType:"html"};$.extend(settings,options);$(":file",$form).each(function(){if(!$(this).val()){$(this).attr("disabled",true);}});$(form).ajaxSubmit(settings);$(":file",$form).each(function(){$(this).attr("disabled",false);
});},_hanlePopupRemoveError:function(statusCode){this._removeLoading();this._showWarn($.Taiji.Messages.ERR_RESPONSE+statusCode);this.isRunning=false;},_handlePopupRemoveSuccess:function(statusCode,responseHeader,responseText,$form){this._removeLoading();this.isRunning=false;if(responseHeader.note){$(this.settings.search.resultClassName,this.currentTarget).find(".taiji_clicked").remove();$(".taiji_pager .totalcount",this.currentTarget).each(function(){$(this).text(parseInt($(this).text(),10)-1);});this._showNote(this.decode(responseHeader.note));$.nmTop().close();if(this.settings.popupRemove.callback&&typeof this.settings.popupRemove.callback){this.settings.popupRemove.callback(responseText);}$(this.currentTarget).triggerHandler("taijiPopupRemoveSuccess",[responseText]);}else{if(responseHeader.jme){this._showWarn(this.decode(responseHeader.jme));}else{if(responseHeader.me){this._showWarn(this.decode(responseHeader.me));}else{if(responseHeader.cve){var jsonData=$.parseJSON(responseText);var $$this=this;
$("[generated=true]",$form).each(function(){$(this).html("");});$.each(jsonData,function(i,n){var $nextLabel=$("[for="+i+"]");if($nextLabel.hasClass($$this.settings.errorClass)){$nextLabel.text(n);$nextLabel.show();}else{$nextLabel=$("<label></label>");$nextLabel.addClass($$this.settings.errorClass);$nextLabel.attr({"for":i,generated:true});$nextLabel.text(n);$("input[name="+i+"]",$form).after($nextLabel);}});this._showWarn($.Taiji.Messages.ERR_CVE);}else{this.warn($.Taiji.Messages.ERR_RESPONSE,statusCode);this._showWarn($.Taiji.Messages.ERR_RESPONSE,statusCode);}}}}}},config:{className:".taiji_popupRemove",callback:function(){}}});var http=/^http:\/\//;$.extend({taijiPopupRemoveSubmit:function(form,option){var nmT=$.nmTop().opener[0].toString();if(http.test(nmT)){nmT=nmT.substr(7);var index=nmT.indexOf("/");nmT=nmT.substr(index);}$("a[href$='"+nmT+"']").parents("._taiji_").data("aTaiji")._handlePopupRemovePost(form,option);}});})(jQuery);(function($){$.Taiji.extendMethod({name:"async",event:{click:{"className":"_handleAsyncClick"}},userNyroModal:false,eventHandler:{_handleAsyncClick:function(element){var $this=$(element);
var $url=$.Taiji.getUrl($this);if(!$url){this.warn($.Taiji.Messages.ERR_URL);return;}var $message=$.Taiji.getConfirmMessage($this);if($message){if(!window.confirm($message)){return false;}}var $asyncConfig=$.extend({},{"interval":4000,"process":$url+"/process"},$this.metadata());var $$this=this;var options={success:function success(responseText,status,xhr){var responseHeader={note:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_NOTE),jme:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_JME),me:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_ME),cve:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_CVE)};$$this._removeLoading();if(responseHeader.jme){$$this._showWarn($$this.decode(responseHeader.jme));}else{if(responseHeader.me){$$this._showWarn($$this.decode(responseHeader.me));}else{if(responseHeader.cve){var ejson=$(responseText).find("#taiji_ejson");var $form=$($$this.searchFormClassName,$$this.currentTarget);var ejsonContent=$.parseJSON($(ejson).html());$.each(ejsonContent,function(i,n){$("[name='"+i+"']",$form).remind(n);
});$$this._showWarn($.Taiji.Messages.ERR_CVE);}else{$$this._showNote(responseText.msg);if($("#process_bar").size()===0){window.setTimeout(function(){$$this._handleAsyncProcess($asyncConfig.process,$asyncConfig.interval);},1000);}}}}},error:function error(xhr){$$this._handleOperateError(xhr.status,$$this);}};this._createLoading($.Taiji.Messages.MSG_OPERATE);if($.Taiji.hasCustomForm(element)){var customForm=$.Taiji.createCustomForm(element);customForm.ajaxSubmit(options);customForm.remove();}else{var searchForm=$(this.searchFormClassName,this.currentTarget);var formAction=searchForm.attr("action");searchForm.attr("action",$url);searchForm.ajaxSubmit(options);searchForm.attr("action",formAction);}},_handleAsyncProcess:function($url,interval){var $this=this;$.ajax({url:$url,type:"POST",data:{},dataType:"json",success:function(responseText,status,xhr){var $process_bar=$("#process_bar");if(responseText.processType==="SUCCESS"){$($this.currentTarget).triggerHandler("taijiAsyncSuccess",[responseText.result]);
$process_bar.remove();return;}var len=responseText.msg.length;var width=len*$this.$fs+120;var offset=$($this.currentTarget).offset();var x=($this.$windowW-width-offset.left)/2+$this.$sw;var percent=Math.round(responseText.percent*100);if($process_bar&&$process_bar.size()===1){$process_bar.css("width",width).css("left",x);$(".taiji_bar_text",$process_bar).text(responseText.msg+"("+percent+"%)");$(".taiji_bar",$process_bar).animate({"width":percent+"%"},interval);}else{$process_bar=$("<div id='process_bar' class='taiji_processing'></div>").css("top",$this.$windowH/5+$this.$sh).css("width",width).css("left",x);var $swap=$("<div class='taiji_bar_swap'></div>");var $bar=$("<div class='taiji_bar'></div>").animate({"width":percent+"%"},interval);var $bar_text=$("<span class='taiji_bar_text'></span>").text(responseText.msg+"("+percent+"%)");$bar.appendTo($swap);$bar_text.appendTo($swap);$swap.appendTo($process_bar);$process_bar.appendTo("body");$bar_text.css("width",width).css("top",($process_bar.height()-$bar_text.height())/2);
}window.setTimeout(function(){$this._handleAsyncProcess($url,interval);},interval);},error:function(xhr){$this._handleOperateError(xhr.status,$this);$this.isRunning=false;}});}},config:{className:".taiji_async"}});})(jQuery);(function($){$.Taiji.extendMethod({name:"collapse",event:{click:{"className":"_handleCollapseClick"}},userNyroModal:false,eventHandler:{_handleCollapseClick:function(element){var a=$(element);var sibling=a.closest("tr").next();if(sibling.hasClass("collapse")){sibling.remove();return;}if(this.isRunning===true){this.warn($.Taiji.Messages.WAR_OPERATE);return;}else{this.isRunning=true;}var $this=this;this._createLoading($.Taiji.Messages.MSG_OPERATE);$.ajax({type:"POST",url:a.attr("href"),success:function(data){var tr,td,container;tr=$("<tr>").addClass("collapse in");td=$("<td>",{"colspan":a.closest("tr").children().length}).appendTo(tr);container=$("<div>",{"class":"well","html":$(data)}).appendTo(td);a.closest("tr").after(tr);},error:function(xhr){$this._showWarn($.Taiji.Messages.ERR_RESPONSE+xhr.status);
},complete:function(xhr){$this.isRunning=false;$this._removeLoading();}});}},config:{className:".taiji_collapse"}});})(jQuery);(function($){$.Taiji.extendMethod({name:"remove",event:{click:{"className":"_handleRemoveClick"}},userNyroModal:false,eventHandler:{_handleRemoveSuccess:function(statusCode,responseHeader,responseText,obj){var $this=$(obj);$this.attr("disabled",false);this._removeLoading();if(responseHeader.note){$this.parents("tr").remove();$(".taiji_pager .totalcount",this.currentTarget).each(function(){$(this).text(parseInt($(this).text(),10)-1);});if(this.settings.remove.callback&&typeof this.settings.remove.callback==="function"){this.settings.remove.callback(responseText);}$(this.currentTarget).triggerHandler("taijiRemoveSuccess",[responseText]);this._showNote(this.decode(responseHeader.note));}else{if(responseHeader.jme){this._showWarn(this.decode(responseHeader.jme));}else{if(responseHeader.me){this._showWarn(this.decode(responseHeader.me));}else{if(responseHeader.cve){this._showWarn(this.decode(responseHeader.cve));
}else{this.warn($.Taiji.Messages.ERR_RESPONSE+statusCode);this._showWarn($.Taiji.Messages.ERR_RESPONSE+statusCode);}}}}this.isRunning=false;},_handleRemoveClick:function(element){var $this=$(element);var $url=$.Taiji.getUrl($this);if(!$url){this.warn($.Taiji.Messages.ERR_URL);return;}var $message=$.Taiji.getConfirmMessage($this);if($message){if(!window.confirm($message)){return false;}}if(this.isRunning===true){this.warn($.Taiji.Messages.WAR_OPERATE);return;}else{this.isRunning=true;}$this.attr("disabled",true);this._createLoading($.Taiji.Messages.MSG_OPERATE);var $$this=this;var options={url:$url,type:"POST",data:{},dataType:"html",success:function(responseText,status,xhr){var responseHeader={note:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_NOTE),jme:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_JME),me:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_ME),cve:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_CVE)};$$this._handleRemoveSuccess(xhr.status,responseHeader,responseText,$this);
},error:function(xhr){$$this._handleOperateError(xhr.status,$this);}};$.ajax(options);},_bindRemove:function(){var $$this=this;$(this.settings.remove.className,this.currentTarget).off("click.taiji").on("click.taiji",function(event){$$this._handleRemoveClick(this);});}},config:{className:".taiji_remove",callback:function(){}}});})(jQuery);(function($){$.Taiji.extendMethod({name:"sortable",event:{click:{"className":"_handleSortableClick"}},userNyroModal:false,eventHandler:{_handleSortableClick:function(element){var base=this;var $this=$(element);if(base.isRunning===true){base.warn($.Taiji.Messages.WAR_OPERATE);return;}var sortName="",sortType="false";if($.metadata){var md=$this.metadata();sortName=md.orderBy;if(!sortName){return;}sortType=md.desc;if($this.hasClass("taiji_asc")){$this.removeClass("taiji_asc").addClass("taiji_desc");sortType="true";}else{if($this.hasClass("taiji_desc")){$this.removeClass("taiji_desc").addClass("taiji_asc");sortType="false";}else{if(sortType===true){$this.addClass("taiji_desc");
}else{$this.addClass("taiji_asc");}}}}else{return;}var sortable=base.settings.sortable;var search=base.settings.search;var $searchForm=$(search.formClassName,base.currentTarget);var $sortName=$(base.currentTarget).find("input[name='orderBy']");if(!$sortName.val()){$sortName=$("<input type='hidden' name='orderBy'/>").appendTo($searchForm);}$sortName.val(sortName);var $sortType=$(base.currentTarget).find("input[name='desc']");if(!$sortType.val()){$sortType=$("<input type='hidden' name='desc'/>").appendTo($searchForm);}$sortType.val(sortType);$(base.searchSubmitClassName,base.currentTarget).trigger("click");}},config:{className:".taiji_sortable"}});})(jQuery);(function($){$.Taiji.extendMethod({name:"topOperate",event:{click:{"className":"_handleTopOperateClick"}},userNyroModal:false,eventHandler:{_handleTopOperateSuccess:function(statusCode,responseHeader,responseText,obj){var $this=$(obj);$this.attr("disabled",false);this._removeLoading();this.isRunning=false;if(responseHeader.note){if(this.settings.topOperate.callback&&typeof this.settings.topOperate.callback==="function"){this.settings.topOperate.callback(responseText);
}$(this.currentTarget).triggerHandler("taijiTopOperateSuccess",[responseText]);this._showNote(this.decode(responseHeader.note));}else{if(responseHeader.jme){this._showWarn(this.decode(responseHeader.jme));}else{if(responseHeader.me){this._showWarn(this.decode(responseHeader.me));}else{if(responseHeader.cve){this._showWarn(this.decode(responseHeader.cve));}else{this.warn($.Taiji.Messages.ERR_RESPONSE+statusCode);this._showWarn($.Taiji.Messages.ERR_RESPONSE+statusCode);}}}}},_handleTopOperateClick:function(element){var $this=$(element);var $url=$.Taiji.getUrl($this);if(!$url){this.warn($.Taiji.Messages.ERR_URL);return;}var $message=$.Taiji.getConfirmMessage($this);if($message){if(!window.confirm($message)){return false;}}if(this.isRunning===true){this.warn($.Taiji.Messages.WAR_OPERATE);return;}else{this.isRunning=true;}$this.attr("disabled",true);this._createLoading($.Taiji.Messages.MSG_OPERATE);var $$this=this;var options={url:$url,type:"POST",dataType:"html",success:function(responseText,status,xhr){var responseHeader={note:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_NOTE),jme:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_JME),me:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_ME),cve:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_CVE)};
$$this._handleTopOperateSuccess(xhr.status,responseHeader,responseText,$this);},error:function(xhr){$$this._handleOperateError(xhr.status,$this);}};$.ajax(options);},_bindTopOperate:function(){var $$this=this;$(this.settings.topOperate.className,this.currentTarget).off("click.taiji").on("click.taiji",function(event){$$this._handleTopOperateClick(this);$.Taiji.preventDefault(event);});}},config:{className:".taiji_topOperate",callback:function(){}}});})(jQuery);(function($){$.Taiji.extendMethod({name:"update",event:{click:{"className":"_handleUpdateClick"}},userNyroModal:false,eventHandler:{_handleUpdateSuccess:function(statusCode,responseHeader,responseText,obj){var $this=$(obj);$this.attr("disabled",false);this._removeLoading();if(responseHeader.note){$this.parents("tr").replaceWith($(responseText).find("tr").addClass("taiji_clicked"));this._bindDataChange();if(this.settings.update.callback&&typeof this.settings.update.callback==="function"){this.settings.update.callback(responseText);}$(this.currentTarget).triggerHandler("taijiUpdateSuccess",[responseText]);
this._showNote(this.decode(responseHeader.note));}else{if(responseHeader.jme){this._showWarn(this.decode(responseHeader.jme));}else{if(responseHeader.me){this._showWarn(this.decode(responseHeader.me));}else{if(responseHeader.cve){this._showWarn(this.decode(responseHeader.cve));}else{this.warn($.Taiji.Messages.ERR_RESPONSE+statusCode);this._showWarn($.Taiji.Messages.ERR_RESPONSE+statusCode);}}}}this.isRunning=false;},_handleUpdateClick:function(element){var $this=$(element);var $url=$.Taiji.getUrl($this);if(!$url){this.warn($.Taiji.Messages.ERR_URL);return;}var $message=$.Taiji.getConfirmMessage($this);if($message){if(!window.confirm($message)){return false;}}if(this.isRunning===true){this.warn($.Taiji.Messages.WAR_OPERATE);return;}else{this.isRunning=true;}$this.attr("disabled",true);this._createLoading($.Taiji.Messages.MSG_OPERATE);var $$this=this;var options={url:$url,type:"POST",dataType:"html",success:function(responseText,status,xhr){var responseHeader={note:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_NOTE),jme:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_JME),me:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_ME),cve:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_CVE)};
$$this._handleUpdateSuccess(xhr.status,responseHeader,responseText,$this);},error:function(xhr){$$this._handleOperateError(xhr.status,$this);}};$.ajax(options);},_bindUpdate:function(){var $$this=this;$(this.settings.update.className,this.currentTarget).off("click.taiji").on("click.taiji",function(){$$this._handleUpdateClick(this);});}},config:{className:".taiji_update",callback:function(){}}});})(jQuery);(function($){$.fn.extend({isVisible:function(){if($(this).isChosenSelect()){return true;}return $(this).attr("type")!=="hidden"&&$(this).css("display")!=="none"&&$(this).css("visibility")!=="hidden";},isChosenSelect:function(){return $(this).is("select")&&$(this).is(":hidden")&&$(this).next().is("div.chosen-container");},remind:function(content,options){var defaults={size:6,align:"center",css:{maxWidth:280,backgroundColor:"#FFFFE0",borderColor:"#F7CE39",color:"#333",fontSize:"12px",padding:"5px 10px",zIndex:"5"}};options=options||{};options.css=$.extend({},defaults.css,options.css);var $remindId=$(this).attr("name")+"_remind";
var params=$.extend({},defaults,options||{});if(!content||!$(this).isVisible()){return;}var objAlign={"center":"50%","left":"15%","right":"85%"},align=objAlign[params.align]||"50%";params.css.position="absolute";params.css.top="-99px";params.css.border="1px solid "+params.css.borderColor;if($("#"+$remindId).size()){$("#"+$remindId).hide();}this.remind=$('<div id="'+$remindId+'" class="taiji_validator">'+content+"</div>").css(params.css);$(this).parent().append(this.remind);var maxWidth;if(!window.XMLHttpRequest&&(maxWidth=parseInt(params.css.maxWidth,10))&&this.remind.width()>maxWidth){this.remind.width(maxWidth);}var offset=$(this).position(),direction="top";if($(this).isChosenSelect()){offset=$(this).next("div").offset();}if(!offset){return $(this);}var remindTop=offset.top-this.remind.outerHeight()-params.size+10;if(remindTop<$(document).scrollTop()){direction="bottom";remindTop=offset.top+$(this).outerHeight()+params.size-10;}var fnCreateCorner=function(beforeOrAfter){var transparent="transparent",dashed="dashed",solid="solid";
var cssWithDirection={},cssWithoutDirection={width:0,height:0,overflow:"hidden",borderWidth:params.size+"px",position:"absolute"},cssFinalUsed={};if(beforeOrAfter==="before"){cssWithDirection={"top":{borderColor:[params.css.borderColor,transparent,transparent,transparent].join(" "),borderStyle:[solid,dashed,dashed,dashed].join(" "),top:0},"bottom":{borderColor:[transparent,transparent,params.css.borderColor,""].join(" "),borderStyle:[dashed,dashed,solid,dashed].join(" "),bottom:0}};}else{if(beforeOrAfter==="after"){cssWithDirection={"top":{borderColor:params.css.backgroundColor+["",transparent,transparent,transparent].join(" "),borderStyle:[solid,dashed,dashed,dashed].join(" "),top:-1},"bottom":{borderColor:[transparent,transparent,params.css.backgroundColor,""].join(" "),borderStyle:[dashed,dashed,solid,dashed].join(" "),bottom:-1}};}else{cssWithDirection=null;cssWithoutDirection=null;cssFinalUsed=null;return null;}}cssFinalUsed=$.extend({},cssWithDirection[direction],cssWithoutDirection);
return $("<"+beforeOrAfter+"></"+beforeOrAfter+">").css(cssFinalUsed);};var cssOuterLimit={width:2*params.size,left:align,marginLeft:(-1*params.size)+"px",height:params.size,textIndent:0,overflow:"hidden",position:"absolute"};if(direction==="top"){cssOuterLimit.bottom=-1*params.size;}else{cssOuterLimit.top=-1*params.size;}this.remind.css({left:offset.left,top:remindTop,marginLeft:$(this).outerWidth()*0.5-this.remind.outerWidth()*parseInt(align,10)/100}).prepend($("<div></div>").css(cssOuterLimit).append(fnCreateCorner("before")).append(fnCreateCorner("after")));$("#"+$remindId).show();$(this).on("focus keydown",function(){$("#"+$remindId).remove();});if($(this).isChosenSelect()){$(this).next("div").on("click",function(){$("#"+$remindId).remove();});}var $$$this=$(this);$(document).on("taijiFixableSuccess",function(){var myP=$$$this.position();remindTop=myP-$("#"+$remindId).outerHeight()-params.size+10;if(direction==="bottom"){remindTop=myP.top+$($$$this).outerHeight()+params.size-10;}$("#"+$remindId).css({top:remindTop});
}).on("taijiResizeSuccess",function(){var myP=$$$this.position();remindTop=myP-$("#"+$remindId).outerHeight()-params.size+10;if(direction==="bottom"){remindTop=myP.top+$($$$this).outerHeight()+params.size-10;}$("#"+$remindId).css({top:remindTop});});return $(this);}});})(jQuery);(function($){$.Taiji.extendMethod({name:"view",event:{click:{"className":"_handleViewClick"}},userNyroModal:true,eventHandler:{_handleViewClick:function(element){var $this=$(element);var $metacurrent=this.getMetaWH($this,"view");$.nmManual($this.attr("href"),$metacurrent);},_bindView:function(){var $$this=this;$(this.settings.view.className,this.currentTarget).off("click.taiji").on("click.taiji",function(event){$$this._handleViewClick(this);});}},config:{className:".taiji_view"}});})(jQuery);var tjUtils=tjUtils||{};(function($){$.extend(tjUtils,{toUpperCase:function(){$(this).val($(this).val().toUpperCase());},toLowerCase:function(){$(this).val($(this).val().toLowerCase());},scb2dbc:function(){var str=$(this).val(),result="";
for(var i=0;i<str.length;i++){var c=str.charCodeAt(i);if(c===12888){result+=String.fromCharCode(32);}else{if(c>65280&&c<65375){result+=String.fromCharCode(c-65248);}else{result+=String.fromCharCode(c);}}}$(this).val(result);},toDbcUpperCase:function(){var str=$(this).val(),result="";for(var i=0;i<str.length;i++){var c=str.charCodeAt(i);if(c===12888){result+=String.fromCharCode(32);}else{if(c>65280&&c<65375){result+=String.fromCharCode(c-65248);}else{result+=String.fromCharCode(c);}}}$(this).val(result.toUpperCase());},toDbcLowerCase:function(){var str=$(this).val(),result="";for(var i=0;i<str.length;i++){var c=str.charCodeAt(i);if(c===12888){result+=String.fromCharCode(32);}else{if(c>65280&&c<65375){result+=String.fromCharCode(c-65248);}else{result+=String.fromCharCode(c);}}}$(this).val(result.toLowerCase());}});})(jQuery);